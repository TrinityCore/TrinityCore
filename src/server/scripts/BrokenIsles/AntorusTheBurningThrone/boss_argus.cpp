/*
 * Copyright 2023 AzgathCore
 *
 * This program is free software; you can redistribute it and/or modify it
 * under the terms of the GNU General Public License as published by the
 * Free Software Foundation; either version 2 of the License, or (at your
 * option) any later version.
 *
 * This program is distributed in the hope that it will be useful, but WITHOUT
 * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for
 * more details.
 *
 * You should have received a copy of the GNU General Public License along
 * with this program. If not, see <http://www.gnu.org/licenses/>.
 */

#include "antorus.h"
#include "AreaTriggerAI.h"
#include "SpellAuraDefines.h"
#include "SpellAuraEffects.h"

enum Says
{
    //Argus
    SAY_AGGRO = 0,
    SAY_WARN_WHISPER_SOULBURST = 1,
    SAY_WARN_WHISPER_SOULBOMB = 2,
    SAY_PHASE_3 = 3,
    SAY_GRASP_OF_THE_UNMAKER = 4,
    SAY_WARN_REORIGINATION_MODULE = 5,
    SAY_WARN_SARGERAS_GAZE = 6,

    //Aman'Thul
    SAY_WARN_SKY_AND_SEA = 0,
    SAY_SKY_AND_SEA = 1,
    SAY_PHASE_2 = 2,
    SAY_AVATAR_OF_AGGRAMAR = 3,
    SAY_TEMPORAL_BLAST = 4,
    SAY_REAP_SOUL = 5,

    //Golganneth
    SAY_WARN_WHISPER_SKY = 0,
    SAY_WARN_WHISPER_SEA = 1,

    //Eonar
    SAY_GIFT_OF_THE_LIFEBINDER = 0,
    SAY_GIFT_OF_THE_LIFEBINDER_2 = 1,

    //Soulblight
    SAY_WARN_SOULBLIGHT_DOT = 0,
};

enum Spells
{
    SPELL_OUTRO = 257606,
    SPELL_ARGUS_BONUS_ROLL = 250608,
    SPELL_DAILY_ESSENCE_ARGUS = 305317,

    SPELL_ZERO_ENERGY_REGEN = 72242,
    SPELL_TITANIC_ESSENCE = 258040,
    SPELL_P1_ENERGY_CONTROLLER = 258041,
    SPELL_P2_ENERGY_CONTROLLER = 258042,
    SPELL_P4_ENERGY_CONTROLLER = 258044,
    SPELL_BERSERK = 26662,

    //Phase 1
    SPELL_CONE_OF_DEATH_FILTER = 256457,
    SPELL_CONE_OF_DEATH_AT = 248166,
    SPELL_SUM_SOULBLIGHT_ORB = 248317,
    SPELL_SOULBLIGHT_ORB_AURA = 248376,
    SPELL_SOULBLIGHT_DOT = 248396,
    SPELL_DEATH_FOG_AT = 248290,
    SPELL_TORTURED_RAGE = 257296,
    SPELL_SWEEPING_SCYTHE = 248499,
    SPELL_SKY_AND_SEA = 255594,
    SPELL_GIFT_OF_THE_SKY_AURA = 258646,
    SPELL_GIFT_OF_THE_SKY_MISSILE = 253884,
    SPELL_GIFT_OF_THE_SEA_AURA = 258647,
    SPELL_GIFT_OF_THE_SEA_MISSILE = 253889,
    //Mythic
    SPELL_SARGERAS_GAZE = 258068,
    SPELL_SARGERAS_RAGE_AT = 257869,
    SPELL_SARGERAS_FEAR_AT = 257931,
    SPELL_SARGERAS_FEAR_VISUAL = 258739,
    SPELL_SARGERAS_FEAR_DMG = 257930,
    SPELL_MYTHIC_P1_CLEANUP = 258083, //Remove "Sargeras Gaze"

    //Phase 2
    SPELL_GOLGANNETH_WRATH_DUMMY = 256674,
    SPELL_GOLGANNETH_WRATH_PERSISTENT = 255648,
    SPELL_GOLGANNETH_WRATH_AURA = 255683,
    SPELL_VOLATILE_SOUL_FILTER = 252280, //100 energy
    SPELL_VOLATILE_SOUL_FILTER_2 = 258043, //50 energy
    SPELL_SOULBURST = 250669,
    SPELL_SOULBURST_DETONATION = 251572,
    SPELL_SOULBOMB = 251570,
    SPELL_EDGE_OF_OBLITERATION_SUMMON = 255826,
    SPELL_EDGE_OF_OBLITERATION_VISUAL = 251779,
    SPELL_EDGE_OF_OBLITERATION_FILTER = 252049,
    SPELL_EDGE_OF_OBLITERATION_AT = 252136,
    SPELL_EDGE_OF_OBLITERATION_DMG = 251815,
    SPELL_EDGE_OF_OBLITERATION_CHARGE = 252152,
    SPELL_AVATAR_OF_AGGRAMAR = 255199,
    SPELL_AGGRAMAR_SACRIFICE = 255201,

    //Phase 3
    SPELL_TEMPORAL_BLAST = 257645,
    SPELL_ARGUS_MYTHIC_TRANSFORM = 258104, //Mythic
    SPELL_ARGUS_MYTHIC_HEAL = 259581, //Mythic
    SPELL_P3_ARCANE_DISSOLVE_OUT = 255976,
    SPELL_CANCEL_AVATAR_OF_AGGRAMAR = 259033,
    SPELL_CONSTELLAR_COMBAT_CHECKER = 259210,
    SPELL_STARBLAST = 253061,
    SPELL_COSMIC_RAY_FILTER = 252729,
    SPELL_COSMIC_RAY_DMG = 252707,
    SPELL_COSMIC_BEACON = 252616,
    SPELL_COSMIC_SMASH = 252630,
    SPELL_BLADES_OF_THE_ETERNAL = 255478,
    SPELL_SWORD_OF_THE_COSMOS = 255496,
    SPELL_COSMIC_POWER = 255935,
    SPELL_THE_DISCS_OF_NORGANNON = 252516,
    SPELL_PHYSICAL_VULNERABILITY = 255418,
    SPELL_HOLY_VULNERABILITY = 255419,
    SPELL_NATURE_VULNERABILITY = 255422,
    SPELL_FROST_VULNERABILITY = 255425,
    SPELL_FIRE_VULNERABILITY = 255429,
    SPELL_SHADOW_VULNERABILITY = 255430,
    SPELL_ARCANE_VULNERABILITY = 255433,
    SPELL_IMPENDING_INEVITABILITY = 253026, //Heroic
    SPELL_INEVITABILITY = 253021,

    //Phase 4
    SPELL_REAP_SOUL_DUMMY = 256542,
    SPELL_REAP_SOUL_KILL_PLAYERS = 258399,
    SPELL_GRASP_OF_THE_UNMAKER = 258373,
    SPELL_P4_ARCANE_DISSOLVE_OUT = 256543,
    SPELL_GIFT_OF_THE_LIFEBINDER = 257619,
    SPELL_END_OF_ALL_THINGS = 256544,
    SPELL_GIFT_OF_THE_LIFEBINDER_AT = 256338,
    SPELL_GIFT_OF_THE_LIFEBINDER_SCRIPT = 256351,
    SPELL_LIFE_GIVING_ROOTS = 256398,
    SPELL_WITHERING_ROOTS = 256399,
    SPELL_KHAZGOROTH_ENERGY_BAR = 257213,
    SPELL_TITANFORGING_PERIODIC_REDUCT_ENERGY = 257214,
    SPELL_TITANFORGED_BUFF = 257215,
    SPELL_SOUL_GHOST = 258826,
    SPELL_HUNGERING_SOUL_AT = 256894,
    SPELL_EMBER_OF_RAGE_AURA = 257300,
    SPELL_EMBER_OF_RAGE_MISSILE = 257298,
    SPELL_REORIGINATION_MODULE_AT = 256389,
    SPELL_INITIALIZATION_SEQUENCE = 256388,
    SPELL_INITIALIZATION_SEQUENCE_SELF_DMG = 256397,
    SPELL_REORIGINATION_PULSE = 256396,
    SPELL_REORIGINATION_DISSOLVE_OUT = 256395,
    SPELL_MOTE_GHOST = 9036,
    SPELL_MOTE_OF_TITANIC_POWER_AT = 253569,
    SPELL_MOTE_OF_TITANIC_POWER_ENERGIZE = 253580,
    SPELL_DEADLY_SCYTHE = 258039, //Heroic
    //Mythic
    SPELL_SOULRENDING_SCYTHE = 258838,
    SPELL_RENT_SOUL_FILTER = 258839,
    SPELL_RENT_SOUL_MISSILE = 258939,
    SPELL_APOCALYPSIS_MODULE_FILTER = 258207,
    SPELL_APOCALYPSIS_MODULE_SUMMON = 258206,
    SPELL_APOCALYPSIS_MODULE_AT = 258007,
    SPELL_APOCALYPSIS_MODULE_PERIODIC = 258029,
    SPELL_APOCALYPSIS_MODULE_REMOVE = 258030,
    SPELL_APOCALYPSIS_PULSE = 258038,
    SPELL_APOCALYPSIS_PULSE_DMG = 258037,
    SPELL_APOCALYPSIS_ZONE_AT = 258034,
    SPELL_SENTENCE_OF_SARGERAS_FILTER = 258088,
    SPELL_SENTENCE_OF_SARGERAS_DMG = 257966,
    SPELL_SHATTERED_BONDS = 258000,
    SPELL_EDGE_OF_ANNIHILATION_VISUAL = 258832,
    SPELL_EDGE_OF_ANNIHILATION_CHARGE = 258833,
    SPELL_EDGE_OF_ANNIHILATION_DMG = 258834,

    //Has player
    SPELL_GHOST_TRACKER = 261228,
    SPELL_VULNERABLE_TO_HUNGERING_SOULS = 260022,
    SPELL_BATTLE_SCENE_STATIC = 255219,
};

enum Events
{
    //Phase 1
    EVENT_SUM_SOULBLIGHT_ORB = 1,
    EVENT_TORTURED_RAGE = 2,
    EVENT_SWEEPING_SCYTHE = 3,
    EVENT_SKY_AND_SEA = 4,

    //Phase 2
    EVENT_P2_ENERGY = 5,
    EVENT_EDGE_OF_OBLITERATION = 6,
    EVENT_AVATAR_OF_AGGRAMAR = 7,

    //Phase 3
    EVENT_TEMPORAL_BLAST = 8,
    EVENT_SUMMON_CONSTELLAR = 9,
    EVENT_COSMIC_BEACON = 10,
    EVENT_STAR_ARSENAL = 11,
    EVENT_THE_DISCS_OF_NORGANNON = 12,

    //Phase 4
    EVENT_GIFT_OF_THE_LIFEBINDER = 13,
    EVENT_END_OF_ALL_THINGS = 14,
    EVENT_REORIGINATION_MODULE = 15,

    //Mythic
    EVENT_SARGERAS_GAZE = 16,
    EVENT_APOCALYPSIS_MODULE = 17,
    EVENT_SENTENCE_OF_SARGERAS = 18,
    EVENT_EDGE_OF_ANNIHILATION = 19,
    EVENT_SOULRENDING_SCYTHE = 20
};

enum Misc
{
    PHASE_1 = 0,
    PHASE_2 = 1,
    PHASE_3 = 2,
    PHASE_4 = 3,

    //SMSG_SET_AI_ANIM_KIT
    ANIM_ARGUS_KNEEL = 3647,
    ANIM_ARGUS_REAP_SOUL = 4942,
    ANIM_GIFT = 2133,
    ANIM_MODUL = 2133,

    SUMMON_GROUP_HUNGERING_SOUL = 3,
    DATA_SARGERAS_GAZE,

    ACTION_1,

    EVENT_1,
    EVENT_2,
    EVENT_3,
    EVENT_4,
    EVENT_5,
    EVENT_6,
};

Position const centrPos = { 2867.12f, -4567.54f, 292.94f };

Position const constellarPos[7] =
{
    {2828.07f, -4553.25f, 292.029f, 5.92f},
    {2856.43f, -4533.67f, 292.027f, 5.00f},
    {2828.72f, -4584.80f, 292.029f, 0.42f},
    {2890.83f, -4538.69f, 292.028f, 4.02f},
    {2852.88f, -4606.91f, 292.029f, 1.22f},
    {2905.77f, -4570.62f, 292.028f, 3.06f},
    {2888.44f, -4600.90f, 292.028f, 2.14f}
};

std::map<uint32, Position> titansPos
{
    { 125885, {2947.36f, -4567.67f, 303.86f, 3.10f} },
    { 125886, {2888.71f, -4496.38f, 296.51f, 4.79f} },
    { 125893, {2923.33f, -4612.22f, 297.24f, 2.59f} },
    { 126266, {2846.21f, -4638.35f, 296.49f, 1.38f} },
    { 126267, {2927.70f, -4523.25f, 300.60f, 3.95f} },
    { 126268, {2845.79f, -4495.85f, 296.42f, 5.09f} }
};

std::vector<uint8> sGazeVector[8]
{
    //Melee: "Rages"    |   Range: "Rages"     |    Random: "Fear"
    {1,                     0,                      1},
    {1,                     0,                      2},
    {1,                     1,                      2},
    {1,                     1,                      3},
    {2,                     1,                      3},
    {2,                     1,                      4},
    {2,                     2,                      4},
    {2,                     2,                      5}
};

uint32 vulnerabilityIDs[7] =
{
    SPELL_FROST_VULNERABILITY,
    SPELL_NATURE_VULNERABILITY,
    SPELL_ARCANE_VULNERABILITY,
    SPELL_HOLY_VULNERABILITY,
    SPELL_SHADOW_VULNERABILITY,
    SPELL_PHYSICAL_VULNERABILITY,
    SPELL_FIRE_VULNERABILITY
};

void AddSC_boss_argus()
{
    
}
