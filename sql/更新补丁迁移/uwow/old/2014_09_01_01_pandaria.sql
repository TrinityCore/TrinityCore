-- Q: 29785 Dafeng, the Spirit of Air
-- terrain phasing id 34604
UPDATE creature set phaseMask = 2 WHERE id = 55665;
UPDATE gameobject set phaseMask = 2 WHERE id = 209685;

--
UPDATE creature set phaseMask = 1 WHERE id = 55672;

--
DELETE FROM `conditions` WHERE SourceTypeOrReferenceId = 23 AND SourceGroup = 5736;
INSERT INTO `conditions` (`SourceTypeOrReferenceId`, `SourceGroup`, `SourceEntry`, `SourceId`, `ElseGroup`, `ConditionTypeOrReference`, `ConditionTarget`, `ConditionValue1`, `ConditionValue2`, `ConditionValue3`, `NegativeCondition`, `ErrorTextId`, `Comment`, `ScriptName`) VALUES
(23, 5736, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 'Pandaren Start loc: world area', ''),
(23, 5736, 3, 0, 1, 8, 0, 29799, 0, 0, 0, 0, 'Pandaren Start loc: tarrain 976', ''),
(23, 5736, 2, 0, 0, 8, 0, 29799, 0, 0, 1, 0, 'Pandaren Start loc: tarrain 975 and not rewarded 29799', ''),
(23, 5736, 2, 0, 0, 28, 0, 30767, 0, 0, 0, 0, 'Pandaren Start loc: tarrain 975', ''),
(23, 5736, 2, 0, 1, 8, 0, 29799, 0, 0, 1, 0, 'Pandaren Start loc: tarrain 975 and not rewarded 29799', ''),
(23, 5736, 2, 0, 1, 8, 0, 30767, 0, 0, 0, 0, 'Pandaren Start loc: tarrain 975', ''),
(23, 5736, 4, 0, 0, 8, 0, 29785, 0, 0, 1, 0, 'Pandaren Start loc: tarrain 975 while not reward 29785', ''),
(23, 5736, 5, 0, 0, 9, 0, 29786, 0, 0, 0, 0, 'Pandaren Start loc: tarrain 975 while taken 29786', ''),
(23, 5736, 6, 0, 0, 8, 0, 29665, 0, 0, 1, 0, 'Pandaren Start loc: tarrain 975 while not rewarded 29665', ''),
(23, 5736, 6, 0, 0, 8, 0, 29786, 0, 0, 0, 0, 'Pandaren Start loc: tarrain 975 while rewarded 29786', ''),
(23, 5736, 6, 0, 1, 28, 0, 29786, 0, 0, 0, 0, 'Pandaren Start loc: tarrain 975 while rewarded 29786', ''),
(23, 5736, 7, 0, 0, 8, 0, 29793, 0, 0, 0, 0, 'Pandaren Start loc: phase 3 while rewarded 29793', ''),
(23, 5736, 7, 0, 0, 8, 0, 29665, 0, 0, 1, 0, 'Pandaren Start loc: phase 3 while not rewarded 29665', '');

DELETE FROM phase_definitions WHERE `zoneId` = 5736;
INSERT INTO `phase_definitions` (`zoneId`, `entry`, `phasemask`, `phaseId`, `terrainswapmap`, `wmAreaId`, `comment`) VALUES
(5736, 1, 0, 0, 0, 683, 'Pandaren Start loc: world area'),
(5736, 2, 0x40, 0, 975, 0, 'Pandaren Start loc: tarrain 975'),
(5736, 3, 0x20, 0, 976, 0, 'Pandaren Start loc: tarrain976'),
(5736, 4, 3, 34604, 0, 0, 'Pandaren Start loc: 3part. Wind cavern'), -- phase
(5736, 5, 5, 34094, 0, 0, 'Pandaren Start loc: 3part. Battle for the Skies'), -- phase
(5736, 6, 9, 524, 0, 0, 'Pandaren Start loc: 3part. Wind cavern. Finish'), -- phase
(5736, 7, 3, 34095, 0, 0, 'Pandaren Start loc: 3part end');

--
DELETE FROM spell_area WHERE spell in (128700, 120749, 118036,
107027, 107032, 100709, 102403, 107028, 100711, 102194, 107033, 102429, 102393, 102395, 114735, 102396, 102397, 
102399, 102400, 102868, 102521, 108150, 108879, 102873, 102869, 103051, 108834, 102872, 102874, 102870, 102875, 116571, 102871, 128574, 103538,
102398, 114455, 109303, 108835, 108823, 108822, 104018, 118028, 104017, 108844, 108842, 105308, 105307, 105005, 105306, 104567, 104334, 104566,
126059, 105333, 106623, 105001, 105002, 105095, 115426, 115435, 115446, 106494, 106622, 115448, 115447, 115449, 117973, 105525, 117501, 117783, 108931,
105096, 108914, 104028) AND  
area in(5834, 5843, 5825, 5835, 5736, 5846, 5849, 5862, 5827, 5881, 5826, 5860, 5830, 5946, 5831, 5886, 5832, 5829, 5820, 5828, 5944, 5833, 5356);
INSERT INTO `spell_area` (`spell`, `area`, `quest_start`, `quest_end`, `aura_spell`, `racemask`, `gender`, `autocast`, `quest_start_status`, `quest_end_status`) VALUES 
-- unk. custom
('128700', '5736', '0', '0', '0', '0', '2', '0', '0', '0'),
('120749', '5356', '0', '0', '0', '0', '2', '0', '0', '0'),
('118036', '5736', '0', '0', '0', '0', '2', '0', '0', '0'),
--
('100709', '5736', '0', '29524', '0', '0', '2', '1', '0', '66'),
--
('102403', '5834', '29524', '29524', '0', '0', '2', '1', '8', '66'),
--
('107028', '5834', '29406', '29409', '0', '0', '2', '1', '74', '66'),
('107027', '5834', '29406', '29409', '0', '0', '2', '1', '74', '66'),
--
('100711', '5834', '29406', '29409', '0', '0', '2', '1', '66', '66'),
('107032', '5834', '29406', '29409', '0', '0', '2', '1', '66', '66'),
--
('107033', '5834', '29409', '29419', '0', '0', '2', '1', '8', '66'),
('102429', '5843', '29409', '29419', '0', '0', '2', '1', '8', '66'),
('102429', '5825', '29409', '29419', '0', '0', '2', '1', '8', '66'),
--
('102194', '5825', '29409', '29419', '0', '0', '2', '1', '66', '66'),
('102194', '5834', '29409', '29419', '0', '0', '2', '1', '66', '66'),
('102194', '5843', '29409', '29419', '0', '0', '2', '1', '66', '66'),
--
('102393', '5825', '29410', '29419', '0', '0', '2', '1', '66', '66'), -- Aysa of the Tushui
('102393', '5846', '29410', '29419', '0', '0', '2', '1', '66', '66'), -- Aysa of the Tushui
--
('102395', '5736', '29419', '29523', '0', '0', '2', '1', '66', '66'),
('114735', '5736', '29419', '29414', '0', '0', '2', '1', '66', '74'),
--
('102396', '5736', '29414', '29523', '0', '0', '2', '1', '66', '66'),
--
('102397', '5736', '29523', '29521', '0', '0', '2', '1', '66', '74'),
('102398', '5835', '29523', '29521', '0', '0', '2', '1', '66', '74'), -- master appear after complete
-- 102399
('102399', '5849', '29420', '29521', '0', '0', '2', '1', '74', '74'),
('102400', '5849', '29420', '29521', '0', '0', '2', '1', '74', '74'),
('102521', '5849', '29420', '29521', '0', '0', '2', '1', '74', '74'),
--
-- ('108150', '5736', '29421', '0', '0', '0', '2', '1', '8', '0'),
--
('102868', '5820', '29423', '29774', '0', '0', '2', '1', '74', '74'),    -- 1-й мастер в храме
--
('102872', '5826', '29521', '29662', '0', '0', '2', '1', '74', '64'),
('102872', '5860', '29521', '29662', '0', '0', '2', '1', '74', '64'),
('102872', '5862', '29521', '29662', '0', '0', '2', '1', '74', '64'),
('108834', '5860', '29521', '0', '0', '0', '2', '1', '74', '0'),
('108834', '5826', '29521', '0', '0', '0', '2', '1', '74', '0'),
('102869', '5860', '29521', '0', '0', '0', '2', '1', '74', '0'),
('102869', '5826', '29521', '0', '0', '0', '2', '1', '74', '0'),
('102869', '5862', '29521', '0', '0', '0', '2', '1', '74', '0'),
('108879', '5860', '29521', '0', '0', '0', '2', '1', '74', '0'), --
('108879', '5826', '29521', '0', '0', '0', '2', '1', '74', '0'), --
('102873', '5860', '29521', '0', '0', '0', '2', '1', '74', '0'),
('102873', '5826', '29521', '0', '0', '0', '2', '1', '74', '0'),
('103051', '5826', '29521', '0', '0', '0', '2', '1', '74', '0'),
('103051', '5860', '29521', '0', '0', '0', '2', '1', '74', '0'),
--
('102874', '5736', '29666', '29678', '0', '0', '2', '1', '66', '66'), -- qgiver1
('102870', '5736', '29666', '29678', '0', '0', '2', '1', '66', '66'), -- qgiver2
--
('102875', '5826', '29678', '0', '0', '0', '2', '1', '66', '0'), -- qgiver1
('102875', '5860', '29678', '0', '0', '0', '2', '1', '66', '0'), -- qgiver1
('102875', '5862', '29678', '0', '0', '0', '2', '1', '66', '0'), -- qgiver1
('102871', '5826', '29678', '0', '0', '0', '2', '1', '66', '0'), -- qgiver2
('102871', '5860', '29678', '0', '0', '0', '2', '1', '66', '0'), -- qgiver2
('102871', '5862', '29678', '0', '0', '0', '2', '1', '66', '0'), -- qgiver2
('128574', '5736', '29678', '29679', '0', '0', '2', '1', '66', '66'), -- watter spitit
('116571', '5862', '29678', '0', '0', '0', '2', '1', '74', '0'), -- not remove
--
('103538', '5736', '29679', '29680', '0', '0', '2', '1', '66', '66'), -- Summon Spirit of Water
--
('114455', '5881', '29680', '0', '0', '0', '2', '1', '74', '0'),
('109303', '5881', '29680', '29774', '0', '0', '2', '1', '74', '66'), -- slipping spirit of earth
('108835', '5881', '29680', '0', '0', '0', '2', '1', '74', '0'),
('108823', '5881', '29680', '29771', '0', '0', '2', '1', '74', '64'), -- YoYo
('108822', '5881', '29680', '29768', '0', '0', '2', '1', '74', '66'), -- quest giver
--
('104018', '5881', '29768', '29774', '0', '0', '2', '1', '66', '66'), -- quest giver
('118028', '5881', '29768', '0', '0', '0', '2', '1', '66', '0'), -- quest giver
--
('104017', '5736', '29774', '29775', '0', '0', '2', '1', '66', '66'), -- Summon Spirit of Water and Earth
--
('104028', '5820', '29774', '0', '0', '0', '2', '1', '66', '0'), -- 2-й мастер в храме
--
('108844', '5830', '29776', '0', '0', '0', '2', '1', '74', '0'),
('108842', '5830', '29776', '29782', '0', '0', '2', '1', '74', '64'),
('105308', '5830', '29776', '0', '0', '0', '2', '1', '74', '0'), -- aisa
('105308', '5946', '29776', '0', '0', '0', '2', '1', '74', '0'), -- aisa
('105307', '5830', '29776', '0', '0', '0', '2', '1', '74', '0'),
('105005', '5830', '29776', '0', '0', '0', '2', '1', '74', '0'),
--
('105306', '5831', '29780', '29784', '0', '0', '2', '1', '74', '74'),
--
('104567', '5886', '29785', '29786', '0', '0', '2', '1', '74', '74'),
('104334', '5886', '29785', '29786', '0', '0', '2', '1', '74', '74'),
('104566', '5886', '29785', '29786', '0', '0', '2', '1', '74', '74'),    -- aisa come to wind spirit
--
('126059', '5886', '29786', '29787', '0', '0', '2', '1', '74', '74'),    -- summon aisa & defang for battle
-- 104762 phase spell, but already done by terrain phasing
('105333', '5829', '29787', '29787', '0', '0', '2', '1', '8', '64'),
-- 105001
('106623', '5832', '29790', '29790', '0', '0', '2', '1', '8', '64'),
--
('105001', '5832', '29790', '0', '0', '0', '2', '1', '66', '0'),
--
('105002', '5832', '29791', '0', '0', '0', '2', '0', '74', '0'),    -- no autocast
-- 105095
('105095', '5820', '29791', '0', '0', '0', '2', '1', '74', '0'),    -- мастер в храме
('106494', '5820', '29792', '0', '0', '0', '2', '1', '74', '0'),
--
('106622', '5832', '29787', '29790', '0', '0', '2', '1', '66', '74'),
--
('115426', '5736', '29792', '29792', '0', '0', '2', '0', '8', '66'),    -- no autocast
('115435', '5736', '29792', '29792', '0', '0', '2', '0', '8', '66'),    -- no autocast
-- 115446
('115446', '5828', '29792', '29792', '0', '0', '2', '1', '8', '66'), -- mandori pre-event
('115448', '5828', '29792', '29792', '0', '0', '2', '1', '8', '66'), -- mandori pre-event
('115447', '5828', '29792', '29792', '0', '0', '2', '1', '8', '66'), -- mandori pre-event
('115449', '5828', '29792', '29792', '0', '0', '2', '1', '8', '66'), -- mandori pre-event hack
--
('117973', '5944', '30589', '30589', '0', '0', '2', '1', '10', '64'),
--
('105525', '5833', '29794', '29794', '0', '0', '2', '1', '8', '66'),
--
('117501', '5736', '29796', '30767', '0', '0', '2', '1', '74', '74'),
-- 117501
('117783', '5736', '29799', '29799', '0', '0', '2', '0', '8', '66'),    -- no autocast
--
('108931', '5736', '29800', '0', '0', '0', '2', '1', '74', '0'),
--
('105096', '5820', '29800', '0', '0', '0', '2', '1', '74', '0'),
('108914', '5820', '29800', '0', '0', '0', '2', '1', '74', '0');

--
DELETE FROM `creature_addon` WHERE guid in (select guid from creature where id = 55672);
UPDATE `creature_template_addon` SET `auras` = '108900 65499 126160' WHERE `creature_template_addon`.`entry` = 55672;

--
UPDATE `creature_template` SET `npcflag` = '16777216' WHERE `entry` = 55999;

--
UPDATE `creature_template` SET `npcflag` = '2' WHERE `creature_template`.`entry` = 56416;

--
DELETE FROM smart_scripts WHERE entryorguid in (65471, 54587);

-- ----------------------------------------
-- Q: 29524 The Lesson of Stifled Pride
-- ----------------------------------------
UPDATE  `creature_template` SET  `AIName`='', `ScriptName` =  'mob_tushui_trainee' WHERE  `entry`  in (54587, 65471);
DELETE FROM `creature_text` WHERE entry =65471;
DELETE FROM `locales_creature_text` WHERE `entry` = 65471;
INSERT INTO `creature_text` (`entry`, `groupid`, `id`, `text`, `type`, `language`, `probability`, `emote`, `duration`, `sound`, `comment`) VALUES
(65471, 0, 0, 'Моему искусству не сравниться с твоим. Я признаю поражение.', 12, 0, 100, 1, 0, 33646, 'Ученик Тушуй'),
(65471, 0, 1, 'Прекрасный бой. Мне можно будет многому у тебя научиться.', 12, 0, 100, 1, 0, 33645, 'Ученик Тушуй'),
(65471, 0, 2, 'Мне никогда не приходилось видеть таких способных новичков. Я должна рассказать остальным.', 12, 0, 100, 1, 0, 33643, 'Ученик Тушуй'),
(65471, 0, 3, 'Достойный поединок, друг.', 12, 0, 100, 1, 0, 33646, 'Ученик Тушуй'),
(65471, 0, 4, 'Моему искусству не сравниться с твоим. Я признаю поражение.', 12, 0, 100, 1, 0, 33646, 'Ученик Тушуй');

DELETE FROM `creature_text` WHERE entry =54587;
DELETE FROM `locales_creature_text` WHERE `entry` = 54587;
INSERT INTO `creature_text` (`entry`, `groupid`, `id`, `text`, `type`, `language`, `probability`, `emote`, `duration`, `sound`, `comment`) VALUES
(54587, 0, 0, 'Это был хороший бой. Благодарю тебя.', 12, 0, 100, 1, 0, 33643, 'Ученик Тушуй'),
(54587, 0, 1, 'Твое мастерство не вызывает сомнений. Я сдаюсь.', 12, 0, 100, 1, 0, 33646, 'Ученик Тушуй'),
(54587, 0, 2, 'Достойный поединок, друг.', 12, 0, 100, 1, 0, 33643, 'Ученик Тушуй'),
(54587, 0, 3, 'Прекрасный бой. Мне можно будет многому у тебя научиться.', 12, 0, 100, 1, 0, 33645, 'Ученик Тушуй'),
(54587, 0, 4, 'Спасибо за напоминание о том, что нужно тренироваться усерднее.', 12, 0, 100, 1, 0, 33643, 'Ученик Тушуй');

--
UPDATE creature set phaseMask = 1 WHERE id = 54786;