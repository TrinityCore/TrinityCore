--
SET @OGUID := 85222;

DELETE FROM `smart_scripts` WHERE `entryorguid` IN (-48245, 29999) AND `source_type` = 0;
INSERT INTO `smart_scripts` (`entryorguid`,`source_type`,`id`,`link`,`event_type`,`event_phase_mask`,`event_chance`,`event_flags`,`event_param1`,`event_param2`,`event_param3`,`event_param4`,`event_param5`,`action_type`,`action_param1`,`action_param2`,`action_param3`,`action_param4`,`action_param5`,`action_param6`,`target_type`,`target_param1`,`target_param2`,`target_param3`,`target_param4`,`target_x`,`target_y`,`target_z`,`target_o`,`comment`) VALUES
(-48245,0,0,0,1,0,100,0,3000,3000,3000,3000,0,11,55693,0,0,0,0,0,1,0,0,0,0,0,0,0,0,"Cave Explosion Bunny - Out of Combat - Cast 'Remove Collapsing Cave Aura'"),

(29999,0,0,0,38,0,100,0,0,1,0,0,0,11,59383,0,0,0,0,0,1,0,0,0,0,0,0,0,0,"Cave Explosion Bunny - On Data Set 0 1 - Cast 'Cave Explosion'");

DELETE FROM `conditions` WHERE `SourceTypeOrReferenceId` = 13 AND `SourceEntry` = 59383;
INSERT INTO `conditions` (`SourceTypeOrReferenceId`,`SourceGroup`,`SourceEntry`,`SourceId`,`ElseGroup`,`ConditionTypeOrReference`,`ConditionTarget`,`ConditionValue1`,`ConditionValue2`,`ConditionValue3`,`NegativeCondition`,`ErrorType`,`ErrorTextId`,`ScriptName`,`Comment`) VALUES
(13,1,59383,0,0,31,0,3,29999,0,0,0,0,"","Group 0: Spell 'Cave Explosion' (Effect 0) targets creature 'Cave Explosion Bunny'");

--
DELETE FROM `smart_scripts` WHERE `entryorguid` = 29626 AND `source_type` = 0;
INSERT INTO `smart_scripts` (`entryorguid`,`source_type`,`id`,`link`,`event_type`,`event_phase_mask`,`event_chance`,`event_flags`,`event_param1`,`event_param2`,`event_param3`,`event_param4`,`event_param5`,`action_type`,`action_param1`,`action_param2`,`action_param3`,`action_param4`,`action_param5`,`action_param6`,`target_type`,`target_param1`,`target_param2`,`target_param3`,`target_param4`,`target_x`,`target_y`,`target_z`,`target_o`,`comment`) VALUES
(29626,0,0,0,11,0,100,0,0,0,0,0,0,1,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,"Tormar Frostgut - On Spawn - Say Line 0"),
(29626,0,1,0,11,0,100,0,0,0,0,0,0,53,0,29626,0,0,0,0,1,0,0,0,0,0,0,0,0,"Tormar Frostgut - On Spawn - Start Waypoint"),
(29626,0,2,0,0,0,100,0,3000,6000,12000,15000,0,11,50410,0,0,0,0,0,2,0,0,0,0,0,0,0,0,"Tormar Frostgut - In Combat - Cast 'Tusk Strike'"),
(29626,0,3,0,0,0,100,0,7000,9000,15000,18000,0,11,11876,0,0,0,0,0,1,0,0,0,0,0,0,0,0,"Tormar Frostgut - In Combat - Cast 'War Stomp'"),
-- Fails sometimes for unknown reason
(29626,0,4,0,6,0,100,0,0,0,0,0,0,11,55486,2,0,0,0,0,1,0,0,0,0,0,0,0,0,"Tormar Frostgut - On Death - Cast 'Collapsing Cave'"),
(29626,0,5,0,6,0,100,0,0,0,0,0,0,45,0,1,0,0,0,0,11,29999,100,0,0,0,0,0,0,"Tormar Frostgut - On Death - Set Data 0 1 (Cave Explosion Bunny)");

DELETE FROM `waypoints` WHERE `entry` = 29626;
INSERT INTO `waypoints` (`entry`,`pointid`,`position_x`,`position_y`,`position_z`,`point_comment`) VALUES
(29626,1,6459.588,-1737.343,484.04303,"Tormar Frostgut"), -- Not sure
(29626,2,6470.204,-1743.3411,486.7431,"Tormar Frostgut"),
(29626,3,6488.025,-1747.5215,488.07083,"Tormar Frostgut");

-- They're indeed visible on retail(red thingy)
DELETE FROM `gameobject` WHERE `guid` BETWEEN @OGUID+00 AND @OGUID+30 AND `id` = 191794;
INSERT INTO `gameobject` (`guid`, `id`, `map`, `zoneId`, `areaId`, `spawnDifficulties`, `phaseId`, `position_x`, `position_y`, `position_z`, `orientation`, `rotation0`, `rotation1`, `rotation2`, `rotation3`, `spawntimesecs`, `animprogress`, `state`, `VerifiedBuild`) VALUES
(@OGUID+00, 191794, 571, 0, 0, '0', 0, 6479.44384765625, -1707.6805419921875, 521.9549560546875, 2.373644113540649414, 0, 0, 0.927183151245117187, 0.37460830807685852, 120, 255, 1, 15595), -- 191794 (Area: 4421 - Difficulty: 0)
(@OGUID+01, 191794, 571, 0, 0, '0', 0, 6427.76123046875, -1708.6875, 460.310760498046875, 5.95157480239868164, 0, 0, -0.16504669189453125, 0.986285746097564697, 120, 255, 1, 15595), -- 191794 (Area: 4421 - Difficulty: 0)
(@OGUID+02, 191794, 571, 0, 0, '0', 0, 6501.4443359375, -1691.4739990234375, 520.46319580078125, 3.194002151489257812, 0, 0, -0.99965667724609375, 0.026201646775007247, 120, 255, 1, 15595), -- 191794 (Area: 4421 - Difficulty: 0)
(@OGUID+03, 191794, 571, 0, 0, '0', 0, 6449.61962890625, -1726.282958984375, 508.12164306640625, 5.532694816589355468, 0, 0, -0.3665008544921875, 0.93041771650314331, 120, 255, 1, 15595), -- 191794 (Area: 4421 - Difficulty: 0)
(@OGUID+04, 191794, 571, 0, 0, '0', 0, 6525.82666015625, -1670.8836669921875, 481.585296630859375, 1.710421562194824218, 0, 0, 0.754709243774414062, 0.656059443950653076, 120, 255, 1, 15595), -- 191794 (Area: 4421 - Difficulty: 0)
(@OGUID+05, 191794, 571, 0, 0, '0', 0, 6438.671875, -1691.7708740234375, 496, 4.45059061050415039, 0, 0, -0.79335308074951171, 0.608761727809906005, 120, 255, 1, 15595), -- 191794 (Area: 4421 - Difficulty: 0)
(@OGUID+06, 191794, 571, 0, 0, '0', 0, 6520.10791015625, -1734.326416015625, 461.0401611328125, 4.171337604522705078, 0, 0, -0.87035560607910156, 0.492423713207244873, 120, 255, 1, 15595), -- 191794 (Area: 4421 - Difficulty: 0)
(@OGUID+07, 191794, 571, 0, 0, '0', 0, 6550.20654296875, -1673.5694580078125, 472.538970947265625, 2.635444164276123046, 0, 0, 0.96814727783203125, 0.250381410121917724, 120, 255, 1, 15595), -- 191794 (Area: 4421 - Difficulty: 0)
(@OGUID+08, 191794, 571, 0, 0, '0', 0, 6451.85693359375, -1721.4478759765625, 457.925933837890625, 5.113816738128662109, 0, 0, -0.55193614959716796, 0.833886384963989257, 120, 255, 1, 15595), -- 191794 (Area: 4421 - Difficulty: 0)
(@OGUID+09, 191794, 571, 0, 0, '0', 0, 6491.69873046875, -1745.515625, 542.38311767578125, 0.453785061836242675, 0, 0, 0.224950790405273437, 0.974370121955871582, 120, 255, 1, 15595), -- 191794 (Area: 4421 - Difficulty: 0)
(@OGUID+10, 191794, 571, 0, 0, '0', 0, 6447.8125, -1755.09375, 456.65435791015625, 0.052358884364366531, 0, 0, 0.02617645263671875, 0.999657332897186279, 120, 255, 1, 15595), -- 191794 (Area: 4421 - Difficulty: 0)
(@OGUID+11, 191794, 571, 0, 0, '0', 0, 6421.02587890625, -1716.9791259765625, 500.007659912109375, 5.829400539398193359, 0, 0, -0.22495079040527343, 0.974370121955871582, 120, 255, 1, 15595), -- 191794 (Area: 4421 - Difficulty: 0)
(@OGUID+12, 191794, 571, 0, 0, '0', 0, 6467.791015625, -1748.9947509765625, 511.332244873046875, 0, 0, 0, 0, 1, 120, 255, 1, 15595), -- 191794 (Area: 4421 - Difficulty: 0)
(@OGUID+13, 191794, 571, 0, 0, '0', 0, 6452.1181640625, -1674.2899169921875, 459.988189697265625, 4.939284324645996093, 0, 0, -0.6225137710571289, 0.78260880708694458, 120, 255, 1, 15595), -- 191794 (Area: 4421 - Difficulty: 0)
(@OGUID+14, 191794, 571, 0, 0, '0', 0, 6529.01025390625, -1723.248291015625, 457.228729248046875, 1.274088263511657714, 0, 0, 0.594821929931640625, 0.80385744571685791, 120, 255, 1, 15595), -- 191794 (Area: 4421 - Difficulty: 0)
(@OGUID+15, 191794, 571, 0, 0, '0', 0, 6481.77685546875, -1752.0069580078125, 458.77545166015625, 0.139624491333961486, 0, 0, 0.06975555419921875, 0.997564136981964111, 120, 255, 1, 15595), -- 191794 (Area: 4421 - Difficulty: 0)
(@OGUID+16, 191794, 571, 0, 0, '0', 0, 6440.15869140625, -1688.6353759765625, 453.01727294921875, 5.253442287445068359, 0, 0, -0.49242305755615234, 0.870355963706970214, 120, 255, 1, 15595), -- 191794 (Area: 4421 - Difficulty: 0)
(@OGUID+17, 191794, 571, 0, 0, '0', 0, 6462.8974609375, -1652.7083740234375, 483.0869140625, 3.804818391799926757, 0, 0, -0.94551849365234375, 0.325568377971649169, 120, 255, 1, 15595), -- 191794 (Area: 4421 - Difficulty: 0)
(@OGUID+18, 191794, 571, 0, 0, '0', 0, 6501.73681640625, -1642.16845703125, 481.7906494140625, 3.45575571060180664, 0, 0, -0.98768806457519531, 0.156436234712600708, 120, 255, 1, 15595), -- 191794 (Area: 4421 - Difficulty: 0)
(@OGUID+19, 191794, 571, 0, 0, '0', 0, 6487.298828125, -1645.28125, 453.6304931640625, 3.560472726821899414, 0, 0, -0.97814750671386718, 0.207912087440490722, 120, 255, 1, 15595), -- 191794 (Area: 4421 - Difficulty: 0)
(@OGUID+20, 191794, 571, 0, 0, '0', 0, 6417.86572265625, -1645.0660400390625, 464.699432373046875, 0.24434557557106018, 0, 0, 0.121869087219238281, 0.9925462007522583, 120, 255, 1, 15595), -- 191794 (Area: 4421 - Difficulty: 0)
(@OGUID+21, 191794, 571, 0, 0, '0', 0, 6489.94287109375, -1626.2691650390625, 452.866119384765625, 4.118979454040527343, 0, 0, -0.88294696807861328, 0.469472706317901611, 120, 255, 1, 15595), -- 191794 (Area: 4421 - Difficulty: 0)
(@OGUID+22, 191794, 571, 0, 0, '0', 0, 6439.7509765625, -1622.467041015625, 450.67022705078125, 5.84685373306274414, 0, 0, -0.21643924713134765, 0.976296067237854003, 120, 255, 1, 15595), -- 191794 (Area: 4421 - Difficulty: 0)
(@OGUID+23, 191794, 571, 0, 0, '0', 0, 6529.01025390625, -1723.248291015625, 457.228729248046875, 1.274088263511657714, 0, 0, 0.594821929931640625, 0.80385744571685791, 120, 255, 1, 15595), -- 191794 (Area: 4421 - Difficulty: 0)
(@OGUID+24, 191794, 571, 0, 0, '0', 0, 6501.73681640625, -1642.16845703125, 481.7906494140625, 3.45575571060180664, 0, 0, -0.98768806457519531, 0.156436234712600708, 120, 255, 1, 15595), -- 191794 (Area: 4421 - Difficulty: 0)
(@OGUID+25, 191794, 571, 0, 0, '0', 0, 6421.02587890625, -1716.9791259765625, 500.007659912109375, 5.829400539398193359, 0, 0, -0.22495079040527343, 0.974370121955871582, 120, 255, 1, 15595), -- 191794 (Area: 4421 - Difficulty: 0)
(@OGUID+26, 191794, 571, 0, 0, '0', 0, 6373.40966796875, -1612.9114990234375, 446.19403076171875, 5.916667938232421875, 0, 0, -0.18223476409912109, 0.98325502872467041, 120, 255, 1, 15595), -- 191794 (Area: 4421 - Difficulty: 0)
(@OGUID+27, 191794, 571, 0, 0, '0', 0, 6381.68994140625, -1637.1649169921875, 439.97314453125, 0, 0, 0, 0, 1, 120, 255, 1, 15595), -- 191794 (Area: 4421 - Difficulty: 0)
(@OGUID+28, 191794, 571, 0, 0, '0', 0, 6397.63916015625, -1619.9288330078125, 454.2960205078125, 5.829400539398193359, 0, 0, -0.22495079040527343, 0.974370121955871582, 120, 255, 1, 15595), -- 191794 (Area: 4421 - Difficulty: 0)
(@OGUID+29, 191794, 571, 0, 0, '0', 0, 6440.15869140625, -1688.6353759765625, 453.01727294921875, 5.253442287445068359, 0, 0, -0.49242305755615234, 0.870355963706970214, 120, 255, 1, 15595), -- 191794 (Area: 4421 - Difficulty: 0)
(@OGUID+30, 191794, 571, 0, 0, '0', 0, 6451.85693359375, -1721.4478759765625, 457.925933837890625, 5.113816738128662109, 0, 0, -0.55193614959716796, 0.833886384963989257, 120, 255, 1, 15595); -- 191794 (Area: 4421 - Difficulty: 0)

DELETE FROM `gameobject_addon` WHERE `guid` BETWEEN @OGUID+00 AND @OGUID+30;
INSERT INTO `gameobject_addon` (`guid`, `parent_rotation0`, `parent_rotation1`, `parent_rotation2`, `parent_rotation3`, `invisibilityType`, `invisibilityValue`) VALUES
(@OGUID+00,0,0,0,1,7,1000),
(@OGUID+01,0,0,0,1,7,1000),
(@OGUID+02,0,0,0,1,7,1000),
(@OGUID+03,0,0,0,1,7,1000),
(@OGUID+04,0,0,0,1,7,1000),
(@OGUID+05,0,0,0,1,7,1000),
(@OGUID+06,0,0,0,1,7,1000),
(@OGUID+07,0,0,0,1,7,1000),
(@OGUID+08,0,0,0,1,7,1000),
(@OGUID+09,0,0,0,1,7,1000),
(@OGUID+10,0,0,0,1,7,1000),
(@OGUID+11,0,0,0,1,7,1000),
(@OGUID+12,0,0,0,1,7,1000),
(@OGUID+13,0,0,0,1,7,1000),
(@OGUID+14,0,0,0,1,7,1000),
(@OGUID+15,0,0,0,1,7,1000),
(@OGUID+16,0,0,0,1,7,1000),
(@OGUID+17,0,0,0,1,7,1000),
(@OGUID+18,0,0,0,1,7,1000),
(@OGUID+19,0,0,0,1,7,1000),
(@OGUID+20,0,0,0,1,7,1000),
(@OGUID+21,0,0,0,1,7,1000),
(@OGUID+22,0,0,0,1,7,1000),
(@OGUID+23,0,0,0,1,7,1000),
(@OGUID+24,0,0,0,1,7,1000),
(@OGUID+25,0,0,0,1,7,1000),
(@OGUID+26,0,0,0,1,7,1000),
(@OGUID+27,0,0,0,1,7,1000),
(@OGUID+28,0,0,0,1,7,1000),
(@OGUID+29,0,0,0,1,7,1000),
(@OGUID+30,0,0,0,1,7,1000);

UPDATE `gameobject_template` SET `AIName` = 'SmartGameObjectAI' WHERE `entry` = 191794;
DELETE FROM `smart_scripts` WHERE `entryorguid` = 191794 AND `source_type` = 1;
INSERT INTO `smart_scripts` (`entryorguid`,`source_type`,`id`,`link`,`event_type`,`event_phase_mask`,`event_chance`,`event_flags`,`event_param1`,`event_param2`,`event_param3`,`event_param4`,`event_param5`,`action_type`,`action_param1`,`action_param2`,`action_param3`,`action_param4`,`action_param5`,`action_param6`,`target_type`,`target_param1`,`target_param2`,`target_param3`,`target_param4`,`target_x`,`target_y`,`target_z`,`target_o`,`comment`) VALUES
(191794,1,0,0,60,0,100,0,10000,10000,10000,10000,0,147,1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,"Falling Rocks - On Update - Activate Object (Animate Custom0)");

UPDATE `gameobject_template_addon` SET `faction` = 114 WHERE `entry` = 191794;
